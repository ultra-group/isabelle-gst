<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><link rel="stylesheet" type="text/css" href="isabelle.css"/>
<title>File ‹Tools/model_components.ML›</title>
</head>


<body>
<div class="head">
<h1>File ‹Tools/model_components.ML›</h1>
</div>

<pre class="source"><span class="comment1">(*------- Model Components -------*)</span>

<span class="keyword1"><span class="keyword">datatype</span></span> <span class="entity">variant</span> <span class="main">=</span> <span class="entity">vari</span> <span class="keyword2"><span class="keyword">of</span></span>
  <span class="main">{</span> tag_name  <span class="main">:</span> string<span class="main">,</span>
    vcases    <span class="main">:</span> term * term * term<span class="main">,</span>
    alpha_typ <span class="main">:</span> term<span class="main">,</span>
    excludes_formulas <span class="main">:</span> term list <span class="main">}</span> 

<span class="keyword1"><span class="keyword">datatype</span></span> <span class="entity">model_comp</span> <span class="main">=</span> <span class="entity">mcomp</span> <span class="keyword2"><span class="keyword">of</span></span> 
  <span class="main">{</span> name <span class="main">:</span> string<span class="main">,</span>
    deps <span class="main">:</span> string list<span class="main">,</span>
    variant <span class="main">:</span> variant option <span class="main">}</span>

<span class="keyword1"><span class="keyword">fun</span></span> <span class="entity">get_mcomp_tag</span> <span class="main">(</span><span class="entity">mcomp</span> <span class="main">{</span><span class="entity">variant</span><span class="main">,</span><span class="main">...</span><span class="main">}</span><span class="main">)</span> <span class="main">=</span> <span class="keyword2"><span class="keyword">case</span></span> <span class="entity">variant</span> <span class="keyword2"><span class="keyword">of</span></span>
    SOME <span class="main">(</span><span class="entity">vari</span> <span class="entity">v</span><span class="main">)</span> <span class="main">=&gt;</span> <span class="main">#</span>tag_name <span class="entity">v</span> 
  <span class="main">|</span> NONE          <span class="main">=&gt;</span> error <span class="inner_quoted">"Cannot get tag name, component has no variant"</span>

<span class="keyword1"><span class="keyword">fun</span></span> <span class="entity">get_mcomp_vcases</span> <span class="main">(</span><span class="entity">mcomp</span> <span class="main">{</span><span class="entity">variant</span><span class="main">,</span><span class="main">...</span><span class="main">}</span><span class="main">)</span> <span class="main">=</span> <span class="keyword2"><span class="keyword">case</span></span> <span class="entity">variant</span> <span class="keyword2"><span class="keyword">of</span></span>
    SOME <span class="main">(</span><span class="entity">vari</span> <span class="entity">v</span><span class="main">)</span> <span class="main">=&gt;</span> <span class="main">#</span>vcases <span class="entity">v</span> 
  <span class="main">|</span> NONE          <span class="main">=&gt;</span> error <span class="inner_quoted">"Cannot get variant cases, component has no variant"</span>

<span class="keyword1"><span class="keyword">fun</span></span> <span class="entity">mk_variants_0</span> <span class="entity">i</span> <span class="entity">A</span> <span class="main">=</span> 
  <span class="entity">HOLogic.mk_Trueprop</span> <span class="main">(</span><span class="entity">HOLogic.mk_eq</span> 
    <span class="main">(</span><span class="antiquoted"><span class="antiquote">@{</span><span class="operator">term</span> <span class="quoted">Variants</span><span class="antiquote">}</span></span> $ <span class="entity">i</span> $ <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">term</span> <span class="quoted"><span class="main">0</span></span><span class="antiquote">}</span></span><span class="main">,</span> Abs <span class="main">(</span><span class="inner_quoted">"x"</span><span class="main">,</span> <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">typ</span> <span class="quoted"><span class="tfree">'a</span></span><span class="antiquote">}</span></span><span class="main">,</span> <span class="entity">A</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> 

<span class="keyword1"><span class="keyword">fun</span></span> <span class="entity">mk_variants_succ</span> <span class="entity">i</span> <span class="entity">F</span> <span class="main">=</span> 
  <span class="entity">HOLogic.mk_Trueprop</span> <span class="main">(</span><span class="entity">mk_tall</span> <span class="main">(</span><span class="inner_quoted">"j"</span><span class="main">,</span> <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">typ</span> <span class="quoted"><span class="tfree">'a</span></span><span class="antiquote">}</span></span><span class="main">,</span> <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">term</span> <span class="quoted">Ord</span><span class="antiquote">}</span></span><span class="main">,</span> 
      <span class="entity">HOLogic.mk_eq</span> <span class="main">(</span><span class="antiquoted"><span class="antiquote">@{</span><span class="operator">term</span> <span class="quoted">Variants</span><span class="antiquote">}</span></span> $ <span class="entity">i</span> $ <span class="main">(</span><span class="antiquoted"><span class="antiquote">@{</span><span class="operator">term</span> <span class="quoted">"succ <span class="free">j</span>"</span><span class="antiquote">}</span></span><span class="main">)</span><span class="main">,</span> 
                     <span class="entity">F</span> $ <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">term</span> <span class="quoted">"succ <span class="free">j</span>"</span><span class="antiquote">}</span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span>

<span class="keyword1"><span class="keyword">fun</span></span> <span class="entity">mk_variants_lim</span> <span class="entity">i</span> <span class="entity">G</span> <span class="main">=</span> 
  <span class="entity">HOLogic.mk_Trueprop</span> <span class="main">(</span><span class="entity">mk_tall</span> <span class="main">(</span><span class="inner_quoted">"μ"</span><span class="main">,</span> <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">typ</span> <span class="quoted"><span class="tfree">'a</span></span><span class="antiquote">}</span></span><span class="main">,</span> <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">term</span> <span class="quoted">Limit</span><span class="antiquote">}</span></span><span class="main">,</span>
      <span class="entity">HOLogic.mk_eq</span> <span class="main">(</span><span class="antiquoted"><span class="antiquote">@{</span><span class="operator">term</span> <span class="quoted">Variants</span><span class="antiquote">}</span></span> $ <span class="entity">i</span> $ <span class="main">(</span><span class="antiquoted"><span class="antiquote">@{</span><span class="operator">term</span> <span class="quoted">"<span class="free">μ</span> <span class="main">::</span> <span class="tfree">'a</span>"</span><span class="antiquote">}</span></span><span class="main">)</span><span class="main">,</span> 
                     <span class="entity">G</span> $ <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">term</span> <span class="quoted">"<span class="free">μ</span> <span class="main">::</span> <span class="tfree">'a</span>"</span><span class="antiquote">}</span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span>

<span class="keyword1"><span class="keyword">fun</span></span> <span class="entity">tag_formula</span> <span class="entity">B</span> <span class="main">=</span> 
  <span class="entity">HOLogic.mk_Trueprop</span> <span class="main">(</span><span class="entity">mk_styping_trm</span> <span class="entity">B</span> <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">typ</span> <span class="quoted"><span class="tfree">'a</span></span><span class="antiquote">}</span></span> <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">term</span> <span class="quoted">Tag</span><span class="antiquote">}</span></span><span class="main">)</span> 

<span class="keyword1"><span class="keyword">fun</span></span> <span class="entity">alpha_typ_formula</span> <span class="entity">tag</span> <span class="entity">styp</span> <span class="main">=</span>
  <span class="entity">HOLogic.mk_Trueprop</span> <span class="main">(</span><span class="entity">HOLogic.mk_eq</span> <span class="main">(</span><span class="antiquoted"><span class="antiquote">@{</span><span class="operator">term</span> <span class="quoted">α</span><span class="antiquote">}</span></span> $ <span class="entity">tag</span><span class="main">,</span> <span class="entity">styp</span><span class="main">)</span><span class="main">)</span>

<span class="keyword1"><span class="keyword">fun</span></span> <span class="entity">M_formula</span> <span class="entity">B</span> <span class="main">=</span> 
  <span class="entity">HOLogic.mk_Trueprop</span> <span class="main">(</span><span class="entity">mk_styping_trm</span> <span class="entity">B</span> <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">typ</span> <span class="quoted"><span class="tfree">'a</span></span><span class="antiquote">}</span></span> <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">term</span> <span class="quoted"><span class="keyword1">M</span></span><span class="antiquote">}</span></span><span class="main">)</span> 

<span class="keyword1"><span class="keyword">fun</span></span> <span class="entity">mk_excludes_assms</span> <span class="entity">tag_name</span> <span class="entity">ts</span> <span class="main">=</span>
  <span class="main">(</span>map <span class="main">(</span><span class="keyword1"><span class="keyword">fn</span></span> <span class="entity">i</span> <span class="main">=&gt;</span> <span class="inner_quoted">"excluded_"</span> ^ <span class="entity">tag_name</span> ^<span class="inner_quoted">"_"</span>^ <span class="main">(</span>Int.toString <span class="entity">i</span><span class="main">)</span><span class="main">)</span> 
   <span class="main">(</span><span class="inner_numeral">1</span> upto <span class="main">(</span>length <span class="entity">ts</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> ~~ <span class="entity">ts</span>

<span class="keyword1"><span class="keyword">fun</span></span> <span class="entity">tag_trm</span> <span class="entity">name</span> <span class="main">=</span> Free <span class="main">(</span><span class="entity">name</span><span class="main">,</span> <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">typ</span> <span class="quoted"><span class="tfree">'a</span></span><span class="antiquote">}</span></span><span class="main">)</span>
<span class="keyword1"><span class="keyword">fun</span></span> <span class="entity">mdefault_trm</span> <span class="entity">name</span> <span class="main">=</span> Free <span class="main">(</span><span class="entity">name</span> ^ <span class="inner_quoted">"_mdefault"</span><span class="main">,</span> <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">typ</span> <span class="quoted"><span class="tfree">'a</span></span><span class="antiquote">}</span></span><span class="main">)</span>

<span class="keyword1"><span class="keyword">fun</span></span> <span class="entity">get_mcomp_imports</span> <span class="main">_</span>    <span class="main">[</span><span class="main">]</span> <span class="main">=</span> <span class="main">[</span><span class="antiquoted"><span class="antiquote">@{</span><span class="operator">locale</span> ModelBase<span class="antiquote">}</span></span><span class="main">]</span>
  <span class="main">|</span> <span class="entity">get_mcomp_imports</span> <span class="entity">ctxt</span> <span class="entity">ms</span> <span class="main">=</span> map <span class="main">(</span><span class="entity">get_class</span> <span class="entity">ctxt</span><span class="main">)</span> <span class="entity">ms</span> 
  
<span class="keyword1"><span class="keyword">fun</span></span> <span class="entity">mk_mcomp_class</span> <span class="main">(</span><span class="entity">mcomp</span> <span class="main">{</span><span class="entity">name</span><span class="main">,</span> <span class="entity">deps</span><span class="main">,</span> <span class="entity">variant</span><span class="main">}</span><span class="main">)</span> <span class="entity">ctxt</span> <span class="main">=</span>
  <span class="keyword2"><span class="keyword">let</span></span> <span class="keyword1"><span class="keyword">val</span></span> <span class="entity">imports</span> <span class="main">=</span> <span class="entity">get_mcomp_imports</span> <span class="entity">ctxt</span> <span class="entity">deps</span>
      <span class="keyword1"><span class="keyword">val</span></span> <span class="entity">fixes</span> <span class="main">=</span> <span class="main">[</span><span class="main">(</span><span class="entity">name</span> ^ <span class="inner_quoted">"_mdefault"</span><span class="main">,</span> SOME <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">typ</span> <span class="quoted"><span class="tfree">'a</span></span><span class="antiquote">}</span></span><span class="main">,</span> NoSyn<span class="main">)</span><span class="main">]</span>
      <span class="keyword1"><span class="keyword">val</span></span> <span class="entity">mdefault_m</span> <span class="main">=</span> <span class="main">(</span><span class="entity">name</span> ^ <span class="inner_quoted">"_mdefault_m"</span><span class="main">,</span> <span class="entity">M_formula</span> <span class="main">(</span><span class="entity">mdefault_trm</span> <span class="entity">name</span><span class="main">)</span><span class="main">)</span>
  <span class="keyword2"><span class="keyword">in</span></span> <span class="keyword2"><span class="keyword">case</span></span> <span class="entity">variant</span> <span class="keyword2"><span class="keyword">of</span></span>    
  SOME <span class="main">(</span><span class="entity">vari</span> <span class="main">{</span><span class="entity">tag_name</span><span class="main">,</span> <span class="entity">vcases</span><span class="main">,</span> <span class="entity">alpha_typ</span><span class="main">,</span> <span class="entity">excludes_formulas</span><span class="main">}</span><span class="main">)</span> <span class="main">=&gt;</span> 
      <span class="keyword2"><span class="keyword">let</span></span> <span class="keyword1"><span class="keyword">val</span></span> <span class="entity">tag</span> <span class="main">=</span> <span class="entity">tag_trm</span> <span class="entity">tag_name</span>
          <span class="keyword1"><span class="keyword">val</span></span> <span class="entity">tag_fix</span> <span class="main">=</span> <span class="main">(</span><span class="entity">tag_name</span><span class="main">,</span> SOME <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">typ</span> <span class="quoted"><span class="tfree">'a</span></span><span class="antiquote">}</span></span><span class="main">,</span> NoSyn<span class="main">)</span>
          <span class="keyword1"><span class="keyword">val</span></span> <span class="main">(</span><span class="entity">v0</span><span class="main">,</span> <span class="entity">v_succ</span><span class="main">,</span> <span class="entity">v_lim</span><span class="main">)</span> <span class="main">=</span> <span class="entity">vcases</span>
          <span class="keyword1"><span class="keyword">val</span></span> <span class="entity">assms</span> <span class="main">=</span> 
            <span class="main">[</span> <span class="entity">mdefault_m</span><span class="main">,</span>
             <span class="main">(</span><span class="entity">tag_name</span> ^ <span class="inner_quoted">"_tag"</span><span class="main">,</span> <span class="entity">tag_formula</span> <span class="entity">tag</span><span class="main">)</span><span class="main">,</span>
             <span class="main">(</span><span class="inner_quoted">"v_"</span> ^ <span class="entity">tag_name</span> ^ <span class="inner_quoted">"_0"</span><span class="main">,</span> <span class="entity">mk_variants_0</span> <span class="entity">tag</span> <span class="entity">v0</span><span class="main">)</span><span class="main">,</span>
             <span class="main">(</span><span class="inner_quoted">"v_"</span> ^ <span class="entity">tag_name</span> ^ <span class="inner_quoted">"_succ"</span><span class="main">,</span> <span class="entity">mk_variants_succ</span> <span class="entity">tag</span> <span class="entity">v_succ</span><span class="main">)</span><span class="main">,</span>
             <span class="main">(</span><span class="inner_quoted">"v_"</span> ^ <span class="entity">tag_name</span> ^ <span class="inner_quoted">"_limit"</span><span class="main">,</span> <span class="entity">mk_variants_lim</span> <span class="entity">tag</span> <span class="entity">v_lim</span><span class="main">)</span><span class="main">,</span>
             <span class="main">(</span><span class="inner_quoted">"alpha_"</span> ^ <span class="entity">tag_name</span><span class="main">,</span> <span class="entity">alpha_typ_formula</span> <span class="entity">tag</span> <span class="entity">alpha_typ</span><span class="main">)</span><span class="main">]</span>
           @ <span class="entity">mk_excludes_assms</span> <span class="entity">tag_name</span> <span class="entity">excludes_formulas</span>
       <span class="keyword2"><span class="keyword">in</span></span> <span class="entity">mk_class</span> <span class="entity">name</span> <span class="entity">imports</span> <span class="main">(</span><span class="entity">tag_fix</span> :: <span class="entity">fixes</span><span class="main">)</span> <span class="entity">assms</span> <span class="entity">ctxt</span> <span class="keyword2"><span class="keyword">end</span></span>
   <span class="main">|</span> NONE <span class="main">=&gt;</span> <span class="entity">mk_class</span> <span class="entity">name</span> <span class="entity">imports</span> <span class="entity">fixes</span> <span class="main">[</span><span class="entity">mdefault_m</span><span class="main">]</span> <span class="entity">ctxt</span> <span class="keyword2"><span class="keyword">end</span></span>

<span class="comment1">(*------ Model component morphisms -------*)</span>

<span class="comment1">(*A term morphism is a pair of a morphism, together with a list of 
  terms that forms a subset of the domain of that morphism*)</span>
<span class="comment1">(*The list is the SUPPORT of the tern part of the morphism*)</span>

<span class="keyword1"><span class="keyword">type</span></span> <span class="entity">model_sig</span> <span class="main">=</span> 
  <span class="main">{</span> feature <span class="main">:</span> string<span class="main">,</span>
    morph <span class="main">:</span> morphism<span class="main">,</span>
    support <span class="main">:</span> binding list <span class="main">}</span>

<span class="comment1">(*A model component morphism is a triple (iden, (φ, ts)), where: 
    ▸ ‹iden› is the name of the target feature class
    ▸ ‹φ› is a morphism mapping some constants of a feature's typeclass 
      to model constants, and ‹ts› is a list of those constants *)</span>
<span class="keyword1"><span class="keyword">fun</span></span> <span class="entity">msig_app</span> <span class="main">(</span><span class="entity">msig</span> <span class="main">:</span> <span class="entity">model_sig</span><span class="main">)</span> <span class="main">=</span> Morphism.binding <span class="main">(</span><span class="main">#</span>morph <span class="entity">msig</span><span class="main">)</span> 
<span class="keyword1"><span class="keyword">fun</span></span> <span class="entity">msig_term_app</span> <span class="entity">ctxt</span> <span class="entity">msig</span> <span class="entity">trm</span> <span class="main">=</span> 
  <span class="keyword2"><span class="keyword">let</span></span> <span class="keyword1"><span class="keyword">val</span></span> <span class="entity">bd_map</span> <span class="main">=</span> <span class="main">(</span>Syntax.read_term <span class="entity">ctxt</span> o Binding.name_of 
      o <span class="entity">msig_app</span> <span class="entity">msig</span> o Binding.name<span class="main">)</span> 
  <span class="keyword2"><span class="keyword">in</span></span> <span class="keyword2"><span class="keyword">case</span></span> <span class="entity">trm</span> <span class="keyword2"><span class="keyword">of</span></span>
     Free <span class="main">(</span><span class="entity">id</span><span class="main">,</span><span class="main">_</span><span class="main">)</span> <span class="main">=&gt;</span> <span class="entity">bd_map</span> <span class="entity">id</span>
   <span class="main">|</span> <span class="entity">t</span> <span class="main">=&gt;</span> <span class="entity">t</span>
  <span class="keyword2"><span class="keyword">end</span></span>

<span class="keyword1"><span class="keyword">fun</span></span> <span class="entity">msig_ran</span> <span class="main">(</span><span class="entity">msig</span> <span class="main">:</span> <span class="entity">model_sig</span><span class="main">)</span> <span class="main">=</span> map <span class="main">(</span><span class="entity">msig_app</span> <span class="entity">msig</span><span class="main">)</span> <span class="main">(</span><span class="main">#</span>support <span class="entity">msig</span><span class="main">)</span> 
<span class="keyword1"><span class="keyword">fun</span></span> <span class="entity">msig_term_ran</span> <span class="entity">ctxt</span> <span class="entity">msig</span> <span class="main">=</span> 
  map <span class="main">(</span>Syntax.read_term <span class="entity">ctxt</span> o Binding.name_of o <span class="entity">msig_app</span> <span class="entity">msig</span><span class="main">)</span> <span class="main">(</span><span class="main">#</span>support <span class="entity">msig</span><span class="main">)</span> 

<span class="keyword1"><span class="keyword">fun</span></span> <span class="entity">mk_fun</span> <span class="entity">dom</span> <span class="entity">ran</span> <span class="entity">c</span> <span class="main">=</span> 
  <span class="keyword2"><span class="keyword">case</span></span> List.find <span class="main">(</span><span class="keyword1"><span class="keyword">fn</span></span> <span class="main">(</span><span class="entity">x</span><span class="main">,</span><span class="main">_</span><span class="main">)</span> <span class="main">=&gt;</span> <span class="entity">x</span> <span class="main">=</span> <span class="entity">c</span><span class="main">)</span> <span class="main">(</span>ListPair.zip <span class="main">(</span><span class="entity">dom</span><span class="main">,</span><span class="entity">ran</span><span class="main">)</span><span class="main">)</span> <span class="keyword2"><span class="keyword">of</span></span>
    SOME <span class="main">(</span><span class="main">_</span><span class="main">,</span><span class="entity">y</span><span class="main">)</span> <span class="main">=&gt;</span> <span class="entity">y</span>
  <span class="main">|</span> NONE   <span class="main">=&gt;</span> <span class="entity">c</span>  

<span class="keyword1"><span class="keyword">fun</span></span> <span class="entity">msig_compose</span> <span class="main">(</span><span class="main">(</span><span class="entity">m1</span><span class="main">,</span><span class="entity">s1</span><span class="main">)</span><span class="main">,</span> <span class="main">(</span><span class="entity">m2</span><span class="main">,</span><span class="entity">s2</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span>
  <span class="main">(</span>Morphism.compose <span class="entity">m1</span> <span class="entity">m2</span><span class="main">,</span> <span class="entity">s1</span> @ <span class="entity">s2</span><span class="main">)</span>

<span class="keyword1"><span class="keyword">fun</span></span> <span class="entity">mk_msig</span> <span class="entity">msigs</span> <span class="entity">str</span> <span class="entity">cla</span> <span class="entity">ids</span> <span class="entity">ctxt</span> <span class="main">=</span> 
  <span class="keyword2"><span class="keyword">let</span></span> 
    <span class="keyword1"><span class="keyword">val</span></span> <span class="entity">feat_name</span> <span class="main">=</span> <span class="entity">get_class</span> <span class="entity">ctxt</span> <span class="entity">cla</span>
    <span class="keyword1"><span class="keyword">val</span></span> <span class="entity">feat_params</span> <span class="main">=</span> <span class="entity">get_locale_param_names</span> <span class="main">(</span><span class="entity">get_thy</span> <span class="entity">ctxt</span><span class="main">)</span> <span class="entity">feat_name</span>
    <span class="keyword1"><span class="keyword">val</span></span> <span class="entity">bnds</span> <span class="main">=</span> map Binding.name <span class="entity">ids</span>
    <span class="keyword1"><span class="keyword">val</span></span> <span class="entity">imports</span> <span class="main">=</span> List.foldl <span class="entity">msig_compose</span> <span class="main">(</span>Morphism.identity<span class="main">,</span> <span class="main">[</span><span class="main">]</span><span class="main">)</span> 
        <span class="main">(</span>map <span class="main">(</span><span class="keyword1"><span class="keyword">fn</span></span> <span class="entity">msig</span> <span class="main">:</span> <span class="entity">model_sig</span> <span class="main">=&gt;</span> <span class="main">(</span><span class="main">#</span>morph <span class="entity">msig</span><span class="main">,</span> <span class="main">#</span>support <span class="entity">msig</span><span class="main">)</span><span class="main">)</span> <span class="entity">msigs</span><span class="main">)</span>
    <span class="keyword1"><span class="keyword">val</span></span> <span class="entity">morph</span> <span class="main">=</span> Morphism.binding_morphism <span class="entity">str</span> <span class="main">(</span><span class="entity">mk_fun</span> <span class="entity">feat_params</span> <span class="entity">bnds</span><span class="main">)</span>
    <span class="keyword1"><span class="keyword">val</span></span> <span class="main">(</span><span class="entity">morph'</span><span class="main">,</span> <span class="entity">supp</span><span class="main">)</span> <span class="main">=</span> <span class="entity">msig_compose</span> <span class="main">(</span><span class="main">(</span><span class="entity">morph</span><span class="main">,</span> <span class="entity">feat_params</span><span class="main">)</span><span class="main">,</span> <span class="entity">imports</span><span class="main">)</span>
  <span class="keyword2"><span class="keyword">in</span></span> 
    <span class="main">{</span>feature <span class="main">=</span> <span class="entity">feat_name</span><span class="main">,</span> morph <span class="main">=</span> <span class="entity">morph'</span><span class="main">,</span> support <span class="main">=</span> <span class="entity">supp</span><span class="main">}</span> <span class="main">:</span> <span class="entity">model_sig</span>
  <span class="keyword2"><span class="keyword">end</span></span><span class="main">;</span></pre>
</body>

</html>