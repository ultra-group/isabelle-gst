<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><link rel="stylesheet" type="text/css" href="isabelle.css"/>
<title>File ‹Tools/translate_axioms.ML›</title>
</head>


<body>
<div class="head">
<h1>File ‹Tools/translate_axioms.ML›</h1>
</div>

<pre class="source">
<span class="keyword1"><span class="keyword">fun</span></span> <span class="entity">quant_trans</span> <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">term</span> <span class="quoted">‹All <span class="main">::</span> <span class="main">(</span><span class="tfree">'a</span> <span class="main">⇒</span> bool<span class="main">)</span> <span class="main">⇒</span> bool›</span><span class="antiquote">}</span></span> 
    <span class="main">=</span> <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">term</span> <span class="quoted">mall</span><span class="antiquote">}</span></span>
  <span class="main">|</span> <span class="entity">quant_trans</span> <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">term</span> <span class="quoted">‹All <span class="main">::</span> <span class="main">(</span><span class="main">(</span><span class="tfree">'a</span> <span class="main">⇒</span> <span class="tfree">'a</span><span class="main">)</span> <span class="main">⇒</span> bool<span class="main">)</span> <span class="main">⇒</span> bool›</span><span class="antiquote">}</span></span> 
    <span class="main">=</span> <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">term</span> <span class="quoted">‹tall <span class="main">(</span><span class="keyword1">M</span> <span class="main">→</span> <span class="keyword1">M</span><span class="main">)</span>›</span><span class="antiquote">}</span></span>
  <span class="main">|</span> <span class="entity">quant_trans</span> <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">term</span> <span class="quoted">‹All <span class="main">::</span> <span class="main">(</span><span class="main">(</span><span class="tfree">'a</span> <span class="main">⇒</span> <span class="tfree">'a</span> <span class="main">⇒</span> <span class="tfree">'a</span><span class="main">)</span> <span class="main">⇒</span> bool<span class="main">)</span> <span class="main">⇒</span> bool›</span><span class="antiquote">}</span></span> 
    <span class="main">=</span> <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">term</span> <span class="quoted">‹tall <span class="main">(</span><span class="keyword1">M</span> <span class="main">→</span> <span class="keyword1">M</span> <span class="main">→</span> <span class="keyword1">M</span><span class="main">)</span>›</span><span class="antiquote">}</span></span>
  <span class="main">|</span> <span class="entity">quant_trans</span> <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">term</span> <span class="quoted">‹Ex <span class="main">::</span> <span class="main">(</span><span class="tfree">'a</span> <span class="main">⇒</span> bool<span class="main">)</span> <span class="main">⇒</span> bool›</span><span class="antiquote">}</span></span>
      <span class="main">=</span> <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">term</span> <span class="quoted">mex</span><span class="antiquote">}</span></span>
  <span class="main">|</span> <span class="entity">quant_trans</span> <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">term</span> <span class="quoted">‹Uniq <span class="main">::</span> <span class="main">(</span><span class="tfree">'a</span> <span class="main">⇒</span> bool<span class="main">)</span> <span class="main">⇒</span> bool›</span><span class="antiquote">}</span></span>
      <span class="main">=</span> <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">term</span> <span class="quoted">muniq</span><span class="antiquote">}</span></span>
  <span class="main">|</span> <span class="entity">quant_trans</span> <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">term</span> <span class="quoted">"tall <span class="main">::</span> <span class="main">(</span><span class="main">(</span><span class="tfree">'a</span> <span class="main">::</span> <span class="main">_</span><span class="main">)</span> <span class="main">⇒</span> bool<span class="main">)</span> <span class="main">⇒</span> <span class="main">(</span><span class="tfree">'a</span> <span class="main">⇒</span> bool<span class="main">)</span> <span class="main">⇒</span> bool"</span><span class="antiquote">}</span></span>
      <span class="main">=</span> <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">term</span> <span class="quoted">mtall</span><span class="antiquote">}</span></span>
  <span class="main">|</span> <span class="entity">quant_trans</span> <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">term</span> <span class="quoted">"tex <span class="main">::</span> <span class="main">(</span><span class="tfree">'a</span> <span class="main">⇒</span> bool<span class="main">)</span> <span class="main">⇒</span> <span class="main">(</span><span class="tfree">'a</span> <span class="main">⇒</span> bool<span class="main">)</span> <span class="main">⇒</span> bool"</span><span class="antiquote">}</span></span>
      <span class="main">=</span> <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">term</span> <span class="quoted">mtex</span><span class="antiquote">}</span></span>
  <span class="main">|</span> <span class="entity">quant_trans</span> <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">term</span> <span class="quoted">"tex1 <span class="main">::</span> <span class="main">(</span><span class="tfree">'a</span> <span class="main">⇒</span> bool<span class="main">)</span> <span class="main">⇒</span> <span class="main">(</span><span class="tfree">'a</span> <span class="main">⇒</span> bool<span class="main">)</span> <span class="main">⇒</span> bool"</span><span class="antiquote">}</span></span>
      <span class="main">=</span> <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">term</span> <span class="quoted">mtex1</span><span class="antiquote">}</span></span>
  <span class="main">|</span> <span class="entity">quant_trans</span> <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">term</span> <span class="quoted">"tuniq <span class="main">::</span> <span class="main">(</span><span class="tfree">'a</span> <span class="main">⇒</span> bool<span class="main">)</span> <span class="main">⇒</span> <span class="main">(</span><span class="tfree">'a</span> <span class="main">⇒</span> bool<span class="main">)</span> <span class="main">⇒</span> bool"</span><span class="antiquote">}</span></span>
      <span class="main">=</span> <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">term</span> <span class="quoted">mtuniq</span><span class="antiquote">}</span></span>
  <span class="main">|</span> <span class="entity">quant_trans</span> <span class="entity">c</span> <span class="main">=</span> <span class="entity">c</span> 

<span class="keyword1"><span class="keyword">fun</span></span> <span class="entity">translate_term</span> <span class="entity">ctxt</span> <span class="entity">msig</span> <span class="main">=</span>
  map_aterms <span class="main">(</span><span class="entity">quant_trans</span> o <span class="entity">msig_term_app</span> <span class="entity">ctxt</span> <span class="entity">msig</span><span class="main">)</span>

<span class="comment1">(*Generating goals for proving respectfulness theorems for model consts*)</span>
<span class="keyword1"><span class="keyword">fun</span></span> <span class="entity">rsp_goal'</span> <span class="entity">i</span> <span class="entity">m</span> <span class="main">(</span><span class="entity">t</span><span class="main">,</span><span class="entity">t'</span><span class="main">)</span> <span class="main">=</span> 
  <span class="keyword2"><span class="keyword">case</span></span> fastype_of <span class="entity">t</span> <span class="keyword2"><span class="keyword">of</span></span> 
    Type <span class="main">(</span><span class="inner_quoted">"fun"</span><span class="main">,</span><span class="main">[</span><span class="entity">u</span><span class="main">,</span><span class="main">_</span><span class="main">]</span><span class="main">)</span> <span class="main">=&gt;</span> 
     <span class="main">(</span><span class="keyword2"><span class="keyword">case</span></span> <span class="entity">u</span> <span class="keyword2"><span class="keyword">of</span></span> 
        Type <span class="main">(</span><span class="inner_quoted">"fun"</span><span class="main">,</span> <span class="main">_</span><span class="main">)</span> <span class="main">=&gt;</span> 
          <span class="keyword2"><span class="keyword">let</span></span>
            <span class="keyword1"><span class="keyword">val</span></span> <span class="entity">F</span> <span class="main">=</span> <span class="main">(</span>Var <span class="main">(</span><span class="main">(</span><span class="inner_quoted">"fun1"</span><span class="main">,</span><span class="entity">i</span><span class="main">)</span><span class="main">,</span> <span class="entity">u</span><span class="main">)</span><span class="main">)</span>
            <span class="keyword1"><span class="keyword">val</span></span> <span class="entity">G</span> <span class="main">=</span> <span class="main">(</span>Var <span class="main">(</span><span class="main">(</span><span class="inner_quoted">"fun2"</span><span class="main">,</span><span class="entity">i</span><span class="main">)</span><span class="main">,</span> <span class="entity">u</span><span class="main">)</span><span class="main">)</span>
            <span class="keyword1"><span class="keyword">val</span></span> <span class="entity">imp</span> <span class="main">=</span> Logic.mk_implies 
              <span class="main">(</span><span class="entity">rsp_goal'</span> <span class="main">(</span><span class="entity">i</span>+<span class="inner_numeral">1</span><span class="main">)</span> <span class="entity">m</span> <span class="main">(</span><span class="entity">F</span><span class="main">,</span><span class="entity">G</span><span class="main">)</span><span class="main">,</span>
               <span class="entity">rsp_goal'</span> <span class="main">(</span><span class="entity">i</span>+<span class="inner_numeral">1</span><span class="main">)</span> <span class="entity">m</span> <span class="main">(</span><span class="entity">t</span> $ <span class="entity">F</span><span class="main">,</span> <span class="entity">t'</span> $ <span class="entity">G</span><span class="main">)</span><span class="main">)</span>         
          <span class="keyword2"><span class="keyword">in</span></span> 
            Logic.all_const <span class="entity">u</span> $ lambda <span class="entity">F</span>
              <span class="main">(</span>Logic.all_const <span class="entity">u</span> $ lambda <span class="entity">G</span> <span class="entity">imp</span><span class="main">)</span>
          <span class="keyword2"><span class="keyword">end</span></span>  
       <span class="main">|</span> <span class="main">_</span> <span class="main">=&gt;</span> 
        <span class="keyword2"><span class="keyword">let</span></span>
         <span class="keyword1"><span class="keyword">val</span></span> <span class="entity">x</span> <span class="main">=</span> Var <span class="main">(</span><span class="main">(</span><span class="inner_quoted">"x"</span><span class="main">,</span><span class="entity">i</span><span class="main">)</span><span class="main">,</span> <span class="entity">u</span><span class="main">)</span>
         <span class="keyword1"><span class="keyword">val</span></span> <span class="entity">imp</span> <span class="main">=</span> Logic.mk_implies
            <span class="main">(</span><span class="entity">rsp_goal'</span> <span class="main">(</span><span class="entity">i</span>+<span class="inner_numeral">1</span><span class="main">)</span> <span class="entity">m</span> <span class="main">(</span><span class="entity">x</span><span class="main">,</span><span class="entity">x</span><span class="main">)</span><span class="main">,</span> <span class="entity">rsp_goal'</span> <span class="main">(</span><span class="entity">i</span>+<span class="inner_numeral">1</span><span class="main">)</span> <span class="entity">m</span> <span class="main">(</span><span class="entity">t</span> $ <span class="entity">x</span><span class="main">,</span> <span class="entity">t'</span> $ <span class="entity">x</span><span class="main">)</span><span class="main">)</span>
        <span class="keyword2"><span class="keyword">in</span></span>
         Logic.all_const <span class="entity">u</span> $ lambda <span class="entity">x</span> <span class="entity">imp</span>
        <span class="keyword2"><span class="keyword">end</span></span><span class="main">)</span>
  <span class="main">|</span> <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">typ</span> <span class="quoted"><span class="tfree">'a</span></span><span class="antiquote">}</span></span> <span class="main">=&gt;</span> 
    <span class="keyword2"><span class="keyword">if</span></span> <span class="entity">t</span> <span class="main">=</span> <span class="entity">t'</span> 
      <span class="keyword2"><span class="keyword">then</span></span> <span class="entity">HOLogic.mk_Trueprop</span> <span class="main">(</span><span class="entity">m</span> $ <span class="entity">t</span><span class="main">)</span>
      <span class="keyword2"><span class="keyword">else</span></span> <span class="entity">HOLogic.mk_Trueprop</span> <span class="main">(</span><span class="entity">HOLogic.mk_conj</span> <span class="main">(</span><span class="entity">m</span> $ <span class="entity">t</span><span class="main">,</span> <span class="entity">HOLogic.mk_eq</span> <span class="main">(</span><span class="entity">t</span><span class="main">,</span> <span class="entity">t'</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>
  <span class="main">|</span> <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">typ</span> <span class="quoted">bool</span><span class="antiquote">}</span></span> <span class="main">=&gt;</span> 
    <span class="keyword2"><span class="keyword">if</span></span> <span class="entity">t</span> <span class="main">=</span> <span class="entity">t'</span> 
      <span class="keyword2"><span class="keyword">then</span></span> <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">prop</span> <span class="quoted">True</span><span class="antiquote">}</span></span> 
      <span class="keyword2"><span class="keyword">else</span></span> <span class="entity">HOLogic.mk_Trueprop</span> <span class="main">(</span><span class="entity">HOLogic.mk_eq</span> <span class="main">(</span><span class="entity">t</span><span class="main">,</span> <span class="entity">t'</span><span class="main">)</span><span class="main">)</span>
 <span class="main">|</span> <span class="main">_</span> <span class="main">=&gt;</span> error <span class="inner_quoted">"weird type!"</span>

<span class="keyword1"><span class="keyword">fun</span></span> <span class="entity">rsp_goal</span> <span class="entity">t</span> <span class="main">=</span> <span class="entity">rsp_goal'</span> <span class="inner_numeral">0</span> <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">term</span> <span class="quoted">‹<span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">:</span> <span class="keyword1">M</span>›</span><span class="antiquote">}</span></span> <span class="main">(</span><span class="entity">t</span><span class="main">,</span><span class="entity">t</span><span class="main">)</span>
 
<span class="keyword1"><span class="keyword">fun</span></span> <span class="entity">simp_rsp'</span> <span class="entity">trm</span> <span class="main">=</span>
  <span class="keyword2"><span class="keyword">if</span></span> Logic.is_all <span class="entity">trm</span> <span class="keyword2"><span class="keyword">then</span></span>
    <span class="keyword2"><span class="keyword">case</span></span> Logic.dest_all_global <span class="entity">trm</span> <span class="keyword2"><span class="keyword">of</span></span>
      <span class="main">(</span><span class="main">_</span><span class="main">,</span><span class="antiquoted"><span class="antiquote">@{</span><span class="operator">prop</span> <span class="quoted">True</span><span class="antiquote">}</span></span><span class="main">)</span> <span class="main">=&gt;</span> <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">prop</span> <span class="quoted">True</span><span class="antiquote">}</span></span> 
    <span class="main">|</span> <span class="main">(</span><span class="entity">v</span><span class="main">,</span> <span class="entity">B</span><span class="main">)</span> <span class="main">=&gt;</span> Logic.all <span class="main">(</span>Free <span class="entity">v</span><span class="main">)</span> <span class="main">(</span><span class="entity">simp_rsp'</span> <span class="entity">B</span><span class="main">)</span>
  <span class="keyword2"><span class="keyword">else</span></span> 
    <span class="keyword2"><span class="keyword">if</span></span> Logic.no_prems <span class="entity">trm</span> <span class="keyword2"><span class="keyword">then</span></span> <span class="entity">trm</span> <span class="keyword2"><span class="keyword">else</span></span> 
    <span class="keyword2"><span class="keyword">case</span></span> Logic.dest_implies <span class="entity">trm</span> <span class="keyword2"><span class="keyword">of</span></span>
      <span class="main">(</span><span class="main">_</span><span class="main">,</span> <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">prop</span> <span class="quoted">True</span><span class="antiquote">}</span></span><span class="main">)</span> <span class="main">=&gt;</span> <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">prop</span> <span class="quoted">True</span><span class="antiquote">}</span></span>  
    <span class="main">|</span> <span class="main">(</span><span class="entity">P</span><span class="main">,</span> <span class="entity">Q</span><span class="main">)</span> <span class="main">=&gt;</span> Logic.mk_implies <span class="main">(</span><span class="entity">simp_rsp'</span> <span class="entity">P</span><span class="main">,</span> <span class="entity">simp_rsp'</span> <span class="entity">Q</span><span class="main">)</span>

<span class="keyword1"><span class="keyword">fun</span></span> <span class="entity">simp_rsp</span> <span class="entity">trm</span> <span class="main">=</span> 
  <span class="keyword2"><span class="keyword">let</span></span> <span class="keyword1"><span class="keyword">val</span></span> <span class="entity">trm'</span> <span class="main">=</span> <span class="entity">simp_rsp'</span> <span class="entity">trm</span>
  <span class="keyword2"><span class="keyword">in</span></span> 
    <span class="keyword2"><span class="keyword">if</span></span> <span class="entity">trm'</span> <span class="main">=</span> <span class="entity">trm</span> 
    <span class="keyword2"><span class="keyword">then</span></span> <span class="entity">trm</span> 
    <span class="keyword2"><span class="keyword">else</span></span> <span class="entity">simp_rsp</span> <span class="entity">trm'</span> 
  <span class="keyword2"><span class="keyword">end</span></span>

<span class="keyword1"><span class="keyword">fun</span></span> <span class="entity">gen_axiom_goals</span> <span class="entity">ctxt</span> <span class="entity">msig</span> <span class="main">=</span> 
  <span class="keyword2"><span class="keyword">let</span></span> 
    <span class="keyword1"><span class="keyword">val</span></span> <span class="entity">axioms</span> <span class="main">=</span> map snd <span class="main">(</span><span class="entity">get_locale_axioms</span> <span class="main">(</span><span class="entity">get_thy</span> <span class="entity">ctxt</span><span class="main">)</span> <span class="main">(</span><span class="main">#</span>feature <span class="entity">msig</span><span class="main">)</span><span class="main">)</span>
    <span class="keyword1"><span class="keyword">val</span></span> <span class="main">(</span><span class="entity">typings</span><span class="main">,</span> <span class="entity">axs</span><span class="main">)</span> <span class="main">=</span> List.partition <span class="main">(</span><span class="entity">is_fun_typing</span> o <span class="entity">HOLogic.dest_Trueprop</span><span class="main">)</span> <span class="entity">axioms</span>
    <span class="keyword1"><span class="keyword">val</span></span> <span class="entity">conv_typings</span> <span class="main">=</span> map <span class="main">(</span><span class="entity">HOLogic.mk_Trueprop</span> o <span class="entity">unfold_fun_typing</span> o <span class="entity">HOLogic.dest_Trueprop</span><span class="main">)</span> <span class="entity">typings</span>
  <span class="keyword2"><span class="keyword">in</span></span> 
    map <span class="main">(</span><span class="entity">translate_term</span> <span class="entity">ctxt</span> <span class="entity">msig</span><span class="main">)</span> <span class="main">(</span><span class="entity">conv_typings</span> @ <span class="entity">axs</span><span class="main">)</span> 
  <span class="keyword2"><span class="keyword">end</span></span>

<span class="keyword1"><span class="keyword">val</span></span> <span class="entity">gen_resp_goal</span> <span class="main">=</span> <span class="entity">simp_rsp</span> o <span class="entity">rsp_goal</span>  
<span class="keyword1"><span class="keyword">fun</span></span> <span class="entity">gen_resp_goals</span> <span class="entity">ctxt</span> <span class="entity">msig</span> <span class="main">=</span> 
  filter <span class="main">(</span><span class="keyword1"><span class="keyword">fn</span></span> <span class="entity">p</span> <span class="main">=&gt;</span> not <span class="main">(</span><span class="entity">p</span> <span class="main">=</span> <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">prop</span> <span class="quoted">True</span><span class="antiquote">}</span></span><span class="main">)</span><span class="main">)</span> 
    <span class="main">(</span>map <span class="entity">gen_resp_goal</span> <span class="main">(</span><span class="entity">msig_term_ran</span> <span class="entity">ctxt</span> <span class="entity">msig</span><span class="main">)</span><span class="main">)</span>
   
<span class="keyword1"><span class="keyword">fun</span></span> <span class="entity">after_qed</span> <span class="entity">thm_name</span> <span class="entity">thms</span> <span class="entity">lthy</span> <span class="main">=</span>
  Local_Theory.note <span class="main">(</span><span class="entity">thm_name</span><span class="main">,</span> <span class="main">(</span>flat <span class="entity">thms</span><span class="main">)</span><span class="main">)</span> <span class="entity">lthy</span> |&gt; snd

<span class="keyword1"><span class="keyword">structure</span></span> <span class="entity">ModelMorphResult</span> <span class="main">=</span> Proof_Data
  <span class="main">(</span><span class="keyword1"><span class="keyword">type</span></span> <span class="entity">T</span> <span class="main">=</span> unit <span class="main">-&gt;</span> <span class="entity">model_sig</span>
   <span class="keyword1"><span class="keyword">fun</span></span> <span class="entity">init</span> <span class="main">_</span> <span class="main">(</span><span class="main">)</span> <span class="main">=</span> error <span class="inner_quoted">"Result"</span><span class="main">)</span>

<span class="keyword1"><span class="keyword">val</span></span> <span class="entity">model_morph_result_cookie</span> <span class="main">=</span> 
  <span class="main">(</span>ModelMorphResult.get<span class="main">,</span> ModelMorphResult.put<span class="main">,</span> <span class="inner_quoted">"ModelMorphResult.put"</span><span class="main">)</span>

<span class="keyword1"><span class="keyword">fun</span></span> <span class="entity">src_to_morph</span> <span class="entity">src</span> <span class="entity">ctxt</span> <span class="main">=</span> <span class="keyword2"><span class="keyword">let</span></span>
    <span class="keyword1"><span class="keyword">val</span></span> <span class="main">(</span><span class="entity">text</span><span class="main">,</span> <span class="main">_</span><span class="main">)</span> <span class="main">=</span> Input.source_content <span class="entity">src</span>
    <span class="keyword1"><span class="keyword">val</span></span> <span class="entity">model</span> <span class="main">=</span> <span class="entity">Code_Runtime.value</span> <span class="entity">ctxt</span> <span class="entity">model_morph_result_cookie</span> <span class="main">(</span><span class="inner_quoted">""</span><span class="main">,</span> <span class="entity">text</span><span class="main">)</span>
  <span class="keyword2"><span class="keyword">in</span></span> <span class="entity">model</span> <span class="keyword2"><span class="keyword">end</span></span><span class="main">;</span>

<span class="keyword1"><span class="keyword">fun</span></span> <span class="entity">translate_axioms_cmd</span> <span class="main">(</span><span class="entity">thm_name</span><span class="main">,</span><span class="entity">src</span><span class="main">)</span> <span class="entity">ctxt</span> <span class="main">=</span> <span class="keyword2"><span class="keyword">let</span></span>
  <span class="keyword1"><span class="keyword">val</span></span> <span class="entity">morph</span> <span class="main">=</span> <span class="entity">src_to_morph</span> <span class="entity">src</span> <span class="entity">ctxt</span> 
  <span class="keyword1"><span class="keyword">val</span></span> <span class="entity">goals</span> <span class="main">=</span> <span class="entity">gen_axiom_goals</span> <span class="entity">ctxt</span> <span class="entity">morph</span> 
<span class="keyword2"><span class="keyword">in</span></span> 
     <span class="entity">Proof.refine_singleton</span> <span class="main">(</span><span class="entity">Method.Basic</span> <span class="main">(</span><span class="keyword1"><span class="keyword">fn</span></span> <span class="main">_</span> <span class="main">=&gt;</span> <span class="entity">Method.succeed</span><span class="main">)</span><span class="main">)</span> 
      <span class="main">(</span><span class="main">(</span><span class="entity">Proof.theorem</span> NONE <span class="main">(</span><span class="entity">after_qed</span> <span class="entity">thm_name</span><span class="main">)</span> <span class="main">(</span>map <span class="main">(</span><span class="keyword1"><span class="keyword">fn</span></span> <span class="entity">t</span> <span class="main">=&gt;</span> <span class="main">[</span><span class="main">(</span><span class="entity">t</span><span class="main">,</span><span class="main">[</span><span class="main">]</span><span class="main">)</span><span class="main">]</span><span class="main">)</span> <span class="entity">goals</span><span class="main">)</span> <span class="entity">ctxt</span><span class="main">)</span><span class="main">)</span> 
<span class="keyword2"><span class="keyword">end</span></span>

<span class="keyword1"><span class="keyword">fun</span></span> <span class="entity">resp_thms_cmd</span> <span class="main">(</span><span class="entity">thm_name</span><span class="main">,</span><span class="entity">src</span><span class="main">)</span> <span class="entity">ctxt</span> <span class="main">=</span> 
  <span class="keyword2"><span class="keyword">let</span></span>
    <span class="keyword1"><span class="keyword">val</span></span> <span class="entity">morph</span> <span class="main">=</span> <span class="entity">src_to_morph</span> <span class="entity">src</span> <span class="entity">ctxt</span> 
    <span class="keyword1"><span class="keyword">val</span></span> <span class="entity">goals</span> <span class="main">=</span> <span class="entity">gen_resp_goals</span> <span class="entity">ctxt</span> <span class="entity">morph</span> 
  <span class="keyword2"><span class="keyword">in</span></span> 
    <span class="entity">Proof.refine_singleton</span> <span class="main">(</span><span class="entity">Method.Basic</span> <span class="main">(</span><span class="keyword1"><span class="keyword">fn</span></span> <span class="main">_</span> <span class="main">=&gt;</span> <span class="entity">Method.succeed</span><span class="main">)</span><span class="main">)</span> 
      <span class="main">(</span><span class="main">(</span><span class="entity">Proof.theorem</span> NONE <span class="main">(</span><span class="entity">after_qed</span> <span class="entity">thm_name</span><span class="main">)</span> <span class="main">(</span>map <span class="main">(</span><span class="keyword1"><span class="keyword">fn</span></span> <span class="entity">t</span> <span class="main">=&gt;</span> <span class="main">[</span><span class="main">(</span><span class="entity">t</span><span class="main">,</span><span class="main">[</span><span class="main">]</span><span class="main">)</span><span class="main">]</span><span class="main">)</span> <span class="entity">goals</span><span class="main">)</span> <span class="entity">ctxt</span><span class="main">)</span><span class="main">)</span> 
  <span class="keyword2"><span class="keyword">end</span></span>

<span class="keyword1"><span class="keyword">val</span></span> <span class="main">_</span> <span class="main">=</span> <span class="entity">Outer_Syntax.local_theory_to_proof</span>
  <span class="antiquoted"><span class="entity"><span class="antiquote">@{</span><span class="operator">command_keyword</span> "<span class="keyword1">translate_axioms</span>"<span class="antiquote">}</span></span></span>
  <span class="inner_quoted">"sets up proof of the translation of each axiom of a locale"</span> 
  <span class="main">(</span><span class="entity">Parse_Spec.opt_thm_name</span> <span class="inner_quoted">":"</span> -- Parse.ML_source &gt;&gt; <span class="entity">translate_axioms_cmd</span><span class="main">)</span>

<span class="keyword1"><span class="keyword">val</span></span> <span class="main">_</span> <span class="main">=</span> <span class="entity">Outer_Syntax.local_theory_to_proof</span>
  <span class="antiquoted"><span class="entity"><span class="antiquote">@{</span><span class="operator">command_keyword</span> "<span class="keyword1">resp_thms</span>"<span class="antiquote">}</span></span></span>
  <span class="inner_quoted">"sets up proof of the translation of each axiom of a locale"</span> 
  <span class="main">(</span><span class="entity">Parse_Spec.opt_thm_name</span> <span class="inner_quoted">":"</span> -- Parse.ML_source &gt;&gt; <span class="entity">resp_thms_cmd</span><span class="main">)</span>
</pre>
</body>

</html>